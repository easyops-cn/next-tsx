// Jest Snapshot v1, https://jestjs.io/docs/snapshot-testing

exports[`convertTsx should work 1`] = `
{
  "brick": {
    "brick": "eo-content-layout",
    "children": [
      {
        "brick": "eo-flex-layout",
        "events": undefined,
        "lifeCycle": undefined,
        "properties": {
          "alignItems": "center",
          "gap": "0.5em",
        },
        "slots": {
          "": {
            "bricks": [
              {
                "brick": "eo-search",
                "events": {
                  "search": [
                    {
                      "else": [
                        {
                          "action": "context.set",
                          "args": [
                            "logId",
                            undefined,
                          ],
                          "key": "event",
                        },
                        {
                          "action": "history.pushQuery",
                          "args": [
                            {
                              "logId": null,
                            },
                            {
                              "notify": false,
                            },
                          ],
                          "key": "event",
                        },
                      ],
                      "if": "<% EVENT.detail %>",
                      "key": "event",
                      "then": [
                        {
                          "action": "context.set",
                          "args": [
                            "logId",
                            "<% EVENT.detail %>",
                          ],
                          "key": "event",
                        },
                        {
                          "action": "history.pushQuery",
                          "args": [
                            {
                              "logId": "<% EVENT.detail %>",
                            },
                            {
                              "notify": false,
                            },
                          ],
                          "key": "event",
                        },
                      ],
                    },
                  ],
                },
                "lifeCycle": undefined,
                "properties": {
                  "inputStyle": {
                    "width": "300px",
                  },
                  "placeholder": "输入任务 ID 并按回车",
                  "themeVariant": "elevo",
                  "trim": true,
                  "value": "<%= CTX.logId %>",
                },
              },
              {
                "brick": ":if",
                "dataSource": "<%= CTX.logs %>",
                "events": undefined,
                "lifeCycle": undefined,
                "slots": {
                  "": {
                    "bricks": [
                      {
                        "brick": "eo-button",
                        "events": {
                          "click": [
                            {
                              "action": "context.set",
                              "args": [
                                "allExpanded",
                                "<% !CTX.allExpanded %>",
                              ],
                              "key": "e",
                            },
                          ],
                        },
                        "lifeCycle": undefined,
                        "properties": {
                          "textContent": "<%= FN._helper_mergeTexts({type:"expression",value:(CTX.allExpanded ? "全部收起" : "全部展开")}) %>",
                          "themeVariant": "elevo",
                        },
                      },
                    ],
                    "type": "bricks",
                  },
                },
              },
            ],
            "type": "bricks",
          },
        },
      },
      {
        "brick": ":if",
        "dataSource": "<%= CTX.logs %>",
        "events": undefined,
        "lifeCycle": undefined,
        "slots": {
          "": {
            "bricks": [
              {
                "brick": "eo-next-table",
                "children": [],
                "events": undefined,
                "lifeCycle": undefined,
                "properties": {
                  "columns": [
                    {
                      "dataIndex": "time",
                      "key": "time",
                      "title": "时间",
                      "useBrick": [
                        {
                          "brick": "span",
                          "events": undefined,
                          "lifeCycle": undefined,
                          "properties": {
                            "textContent": "<%= FN._helper_mergeTexts({type:"expression",value:(moment(DATA.cellData * 1000).format("HH:mm:ss"))}) %>",
                          },
                        },
                      ],
                    },
                    {
                      "dataIndex": "opType",
                      "key": "opType",
                      "title": "操作类型",
                      "useBrick": [
                        {
                          "brick": "span",
                          "events": undefined,
                          "lifeCycle": undefined,
                          "properties": {
                            "textContent": "<%= FN._helper_mergeTexts({type:"expression",value:(\`\${DATA.cellData}\${DATA.rowData.opSubType ? \` / \${DATA.rowData.opSubType}\` : ""}\`)}) %>",
                          },
                        },
                      ],
                    },
                    {
                      "dataIndex": "data",
                      "key": "data",
                      "title": "数据",
                      "useBrick": [
                        {
                          "brick": "div",
                          "children": [
                            {
                              "brick": ":if",
                              "dataSource": "<%= CTX.allExpanded || CTX.expandedSet.has(DATA.rowData.logId) %>",
                              "events": undefined,
                              "lifeCycle": undefined,
                              "slots": {
                                "": {
                                  "bricks": [
                                    {
                                      "brick": "eo-code-block",
                                      "events": undefined,
                                      "lifeCycle": undefined,
                                      "properties": {
                                        "language": "json",
                                        "source": "<%= FN.prettierOutput(DATA.cellData) %>",
                                        "style": {
                                          "maxWidth": "696px",
                                        },
                                        "themeVariant": "elevo",
                                      },
                                    },
                                  ],
                                  "type": "bricks",
                                },
                                "else": {
                                  "bricks": [
                                    {
                                      "brick": "span",
                                      "events": undefined,
                                      "lifeCycle": undefined,
                                      "properties": {
                                        "style": {
                                          "display": "block",
                                          "maxWidth": "696px",
                                          "overflow": "hidden",
                                          "textOverflow": "ellipsis",
                                          "whiteSpace": "nowrap",
                                        },
                                        "textContent": "<%= FN._helper_mergeTexts({type:"expression",value:(DATA.cellData)}) %>",
                                      },
                                    },
                                  ],
                                  "type": "bricks",
                                },
                              },
                            },
                          ],
                        },
                      ],
                    },
                    {
                      "dataIndex": "operation",
                      "key": "operation",
                      "title": "操作",
                      "useBrick": [
                        {
                          "brick": "isolated-tpl-0-operations",
                          "events": {
                            "open.detail": [
                              {
                                "action": "context.set",
                                "args": [
                                  "detailLog",
                                  "<% DATA.rowData %>",
                                ],
                                "key": undefined,
                              },
                              {
                                "args": [],
                                "callback": {},
                                "key": undefined,
                                "method": "open",
                                "target": "[data-root-id="test-root"] [data-ref="modalRef-0"]",
                              },
                            ],
                            "toggle": [
                              {
                                "action": "context.set",
                                "args": [
                                  "expandedSet",
                                  "<% new Set(
                        CTX.expandedSet.has(DATA.rowData.logId)
                          ? [...CTX.expandedSet].filter((id) => id !== DATA.rowData.logId)
                          : [...CTX.expandedSet, DATA.rowData.logId]
                      ) %>",
                                ],
                                "key": undefined,
                              },
                            ],
                          },
                          "lifeCycle": undefined,
                          "properties": {
                            "allExpanded": "<%= CTX.allExpanded %>",
                            "expanded": "<%= CTX.expandedSet.has(DATA.rowData.logId) %>",
                          },
                        },
                      ],
                    },
                  ],
                  "dataSource": "<%= { list: CTX.logs } %>",
                  "pagination": false,
                  "rowKey": "logId",
                  "scrollConfig": {
                    "x": "max-content",
                  },
                  "size": "middle",
                  "themeVariant": "elevo",
                },
              },
            ],
            "type": "bricks",
          },
        },
      },
      {
        "brick": "eo-modal",
        "events": undefined,
        "lifeCycle": undefined,
        "portal": true,
        "properties": {
          "cancelText": undefined,
          "confirmText": undefined,
          "dataset": {
            "ref": "modalRef-0",
          },
          "hideCancelButton": true,
          "keyboard": true,
          "maskClosable": true,
          "modalTitle": "<%= CTX.detailLog
            ? \`\${r.opType}\${r.opSubType ? \` / \${r.opSubType}\` : ""}\`
            : "" %>",
          "themeVariant": "elevo",
          "width": "800px",
        },
        "slots": {
          "": {
            "bricks": [
              {
                "brick": "eo-content-layout",
                "slots": {
                  "": {
                    "bricks": [
                      {
                        "brick": ":if",
                        "dataSource": "<%= CTX.detailLog %>",
                        "events": undefined,
                        "lifeCycle": undefined,
                        "slots": {
                          "": {
                            "bricks": [
                              {
                                "brick": "eo-descriptions",
                                "children": [],
                                "events": undefined,
                                "lifeCycle": undefined,
                                "properties": {
                                  "column": 1,
                                  "dataSource": "<%= CTX.detailLog %>",
                                  "list": [
                                    {
                                      "field": "logId",
                                      "label": "日志 ID",
                                    },
                                    {
                                      "field": "conversationId",
                                      "label": "任务 ID",
                                    },
                                    {
                                      "field": "taskId",
                                      "label": "任务 ID",
                                    },
                                    {
                                      "label": "时间",
                                      "useBrick": [
                                        {
                                          "brick": "span",
                                          "events": undefined,
                                          "lifeCycle": undefined,
                                          "properties": {
                                            "textContent": "<%= FN._helper_mergeTexts({type:"expression",value:(moment(DATA.time * 1000).format("llll"))}) %>",
                                          },
                                        },
                                      ],
                                    },
                                  ],
                                  "themeVariant": "elevo",
                                },
                              },
                              {
                                "brick": "eo-code-block",
                                "events": undefined,
                                "lifeCycle": undefined,
                                "properties": {
                                  "language": "json",
                                  "source": "<%= FN.prettierOutput(CTX.detailLog.data) %>",
                                  "themeVariant": "elevo",
                                },
                              },
                            ],
                            "type": "bricks",
                          },
                        },
                      },
                    ],
                    "type": "bricks",
                  },
                },
              },
            ],
            "type": "bricks",
          },
        },
      },
    ],
  },
  "context": [
    {
      "expose": false,
      "name": "logId",
      "track": true,
      "value": "<% QUERY.logId %>",
    },
    {
      "expose": false,
      "name": "allExpanded",
      "track": true,
      "value": false,
    },
    {
      "expose": false,
      "name": "expandedSet",
      "track": true,
      "value": "<% new Set() %>",
    },
    {
      "expose": false,
      "name": "detailLog",
      "track": true,
      "value": null,
    },
    {
      "name": "logs",
      "resolve": {
        "args": [
          "<% \`logs/\${CTX.logId}\` %>",
          undefined,
        ],
        "if": "<% !!CTX.logId %>",
        "onReject": {
          "transform": {
            "value": "<% [] %>",
          },
        },
        "transform": {
          "value": "<% DATA.data.logs %>",
        },
        "useProvider": "basic.http-request",
      },
      "track": true,
      "value": null,
    },
  ],
  "errors": [],
  "functions": [
    {
      "name": "prettierOutput",
      "source": "function prettierOutput(output: string) {
  try {
    const data = JSON.parse(output);
    return JSON.stringify(data, null, 2);
  } catch (e) {
    return output;
  }
}",
      "typescript": true,
    },
    {
      "name": "_helper_mergeTexts",
      "source": "function mock() {}",
      "typescript": true,
    },
  ],
  "templates": [
    {
      "bricks": [
        {
          "brick": "eo-flex-layout",
          "events": undefined,
          "lifeCycle": undefined,
          "properties": {
            "alignItems": "center",
            "gap": "0.5em",
          },
          "slots": {
            "": {
              "bricks": [
                {
                  "brick": ":if",
                  "dataSource": "<%= !STATE.allExpanded %>",
                  "events": undefined,
                  "lifeCycle": undefined,
                  "slots": {
                    "": {
                      "bricks": [
                        {
                          "brick": "eo-button",
                          "events": {
                            "click": [
                              {
                                "action": "tpl.dispatchEvent",
                                "args": [
                                  "toggle",
                                  {
                                    "detail": "<% EVENT.detail %>",
                                  },
                                ],
                                "key": undefined,
                              },
                            ],
                          },
                          "lifeCycle": undefined,
                          "properties": {
                            "textContent": "<%= FN._helper_mergeTexts({type:"expression",value:(STATE.expanded ? "收起" : "展开")}) %>",
                            "themeVariant": "elevo",
                          },
                        },
                      ],
                      "type": "bricks",
                    },
                  },
                },
                {
                  "brick": "eo-button",
                  "events": {
                    "click": [
                      {
                        "action": "tpl.dispatchEvent",
                        "args": [
                          "open.detail",
                          {
                            "detail": "<% EVENT.detail %>",
                          },
                        ],
                        "key": undefined,
                      },
                    ],
                  },
                  "lifeCycle": undefined,
                  "properties": {
                    "textContent": "详情",
                    "themeVariant": "elevo",
                  },
                },
              ],
              "type": "bricks",
            },
          },
        },
      ],
      "name": "isolated-tpl-0-operations",
      "state": [
        {
          "expose": true,
          "name": "expanded",
          "track": true,
          "value": undefined,
        },
        {
          "expose": true,
          "name": "allExpanded",
          "track": true,
          "value": undefined,
        },
      ],
    },
  ],
  "title": "任务日志",
}
`;
